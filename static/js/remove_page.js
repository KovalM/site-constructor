// Generated by CoffeeScript 1.9.3
(function() {
  var load_page;

  $('body').on('click', '.glyphicon-remove', function() {
    var current_page, id;
    id = $(this).parent().attr('id_page');
    $(this).parent().remove();
    $('.for-padding').empty();
    load_page(id);
    $.each($('.for-padding').children('.draggable-raiting'), function(index, val) {
      return $.ajax({
        url: "/rating/",
        type: "GET",
        data: {
          "id_delete_rating": $(val).attr('id_rating')
        }
      });
    });
    $('.for-padding').empty();
    load_page($('.curr_page').attr("id_page"));
    current_page = $(".curr_page");
    return $.ajax({
      url: "/remove_page/",
      type: "POST",
      data: {
        'page_id': id,
        'csrfmiddlewaretoken': $("[name='csrfmiddlewaretoken']").val()
      },
      success: function(data) {
        current_page.addClass('curr_page');
        if (!$('.page-select').is('.curr_page')) {
          $('.page-select:first').addClass('curr_page');
        }
        id = $('.curr_page').attr("id_page");
        load_page(id);
        if (!$('.btn').is('.page-select')) {
          return location.reload();
        }
      },
      error: function() {
        return alert('in remove page');
      }
    });
  });

  load_page = function(id) {
    return $.ajax({
      url: "/editor/" + $('h2').attr("id_project") + '/',
      type: "POST",
      data: {
        'id_return_page': id,
        'csrfmiddlewaretoken': $("[name='csrfmiddlewaretoken']").val()
      },
      async: false,
      success: function(data) {
        return $('.for-padding').append(data.page);
      }
    });
  };

}).call(this);

//# sourceMappingURL=remove_page.js.map
